# yaml-language-server: $schema=maru2.schema.json
inputs:
  text:
    description: Text to echo
    default: "Hello, world!"
    required: true
  short:
    description: Controls whether network tests are run
    default: false

tasks:
  default:
    - uses: echo
      with:
        text: input was '${{ input "text" }}'
    - run: |
        echo "$INPUT_TEXT"
        echo "${{ input "text" }}"
    - run: echo "bar=baz" >> $MARU2_OUTPUT
      id: foo
    - run: |
        echo "got: ${{ from "foo" "bar" }}"

  echo:
    - run: echo "${{ input "text" }}"

  test:
    - run: |
        go test -race -cover -coverprofile=coverage.out -failfast -timeout 3m -short=${{ input "short" }} ./...

  hello-world:
    - run: echo "Hello, World!"

  benchmark:
    - run: hyperfine './bin/maru2 hello-world' 'make hello-world' -N --warmup 10

  fails:
    - run: exit 2

  continues:
    - run: echo 1
    - uses: fails
    - run: echo 3
    - if: always
      run: echo 3
